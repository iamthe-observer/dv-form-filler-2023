import{u as U,s as E,a as v}from"./app-9297243d.js";import{h as O,m as f,u as $,i as M,E as N,c as n,b as e,q as t,A as i,H as b,y as L,o as c}from"./base-606b8221.js";const z={class:"min-h-fit w-full p-2 bg-black"},J={class:"w-full border-2 border-neutral-500 bg-neutral-900 rounded-xl p-2"},K={class:"flex gap-1 w-full items-center justify-between px-2"},Q={key:0,class:"text-end font-bold text-xl"},X={key:1,class:"text-end font-bold text-xl"},Y={key:2,class:"text-end font-bold text-xl"},ee={class:"flex w-full p-2 gap-2"},te={class:"w-1/2 flex flex-col gap-2 aspect-square bg-black rounded-xl p-2 relative"},le={key:0,s:"",class:"indicator w-full h-full"},ae={class:"indicator-item indicator-center badge bg-purple-500 border-none shadow-lg text-black font-bold"},oe=["src"],se={key:1,class:"w-full h-full grid place-items-center"},re=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-14 aspect-square",viewBox:"0 0 24 24"},[e("path",{fill:"currentColor",d:"M19.5 10.925L18.1 12.3q-.275.275-.688.288T16.7 12.3q-.275-.275-.275-.7t.275-.7l1.375-1.4L16.7 8.125q-.275-.275-.275-.687t.275-.713q.3-.3.713-.3t.712.3L19.5 8.1l1.375-1.4q.275-.3.687-.3t.713.3q.3.3.3.713t-.3.712L20.9 9.5l1.4 1.4q.3.3.288.7t-.313.7q-.3.275-.7.288t-.7-.288L19.5 10.925ZM9 12q-1.65 0-2.825-1.175T5 8q0-1.65 1.175-2.825T9 4q1.65 0 2.825 1.175T13 8q0 1.65-1.175 2.825T9 12Zm-8 6v-.8q0-.85.438-1.563T2.6 14.55q1.55-.775 3.15-1.163T9 13q1.65 0 3.25.388t3.15 1.162q.725.375 1.163 1.088T17 17.2v.8q0 .825-.588 1.413T15 20H3q-.825 0-1.413-.588T1 18Z"})],-1),ne=[re],ce=["href","download"],ie={class:"w-1/2 flex flex-col gap-1"},de={class:"flex-1 bg-black rounded-lg flex justify-between items-center px-2 font-bold gap-1"},ue=e("span",null,"Name:",-1),pe={class:"w-full truncate text-right"},fe={class:"flex-1 bg-black rounded-lg flex justify-between items-center px-2 font-bold"},_e=e("span",null,"DOB:",-1),he={class:"flex-1 bg-black rounded-lg flex justify-between items-center px-2 font-bold"},ve=e("span",null,"Created:",-1),be={class:"flex-1 bg-black rounded-lg flex justify-between items-center px-2 font-bold"},ge=e("span",null,"MS:",-1),me={class:"flex-1 bg-black rounded-lg flex justify-between items-center px-2 font-bold"},xe=e("span",null,"Children:",-1),we={class:"flex-1 bg-black rounded-lg flex justify-between items-center px-2 font-bold"},ye=e("span",null,"Applied By:",-1),ke={key:0,class:"w-full py-2 px-2"},qe=e("div",{class:"w-full text-center font-bold uppercase text-xs bg-green-600 text-black border-2 border-green-700 rounded-xl py-1"}," Registered ",-1),Ce=[qe],je={key:1,class:"w-full py-2 px-2"},Ie={key:2,class:"w-full py-2 px-2"},Pe={key:3,class:"w-full py-2 px-2"},Te=e("br",null,null,-1),Ne=O({__name:"applicant",setup(Se){const _=U(),u=f(""),{applicant:a,profiles:R}=E(U()),w=$(),g=f(""),p=f("prime.jpg"),o=f(0),D=f(0),m=f(""),x=f(!1);M(()=>{A()});function A(){chrome.tabs.query({active:!0,currentWindow:!0},function(l){chrome.tabs.sendMessage(l[0].id,{page:"conf"},function(s){s&&(m.value=s)})})}const B=async()=>{var l;x.value=!0;try{const{data:s,error:r}=await v.from("applicants").select("apl_id").eq("apl_id",(l=a.value)==null?void 0:l.apl_id);if(r)throw r;const{data:d,error:h}=await v.from(s.length==0?"applicants_ex":"applicants").update({pconf_code:m.value}).eq("apl_id",a.value.apl_id).select();if(h)throw h;return alert("Saved Confirmation Code!"),x.value=!1,localStorage.removeItem("apl"),w.push("/main"),d}catch(s){x.value=!1,console.log(s)}},F=N(()=>{var l,s,r;if(o.value==0)return(l=a.value)==null?void 0:l.pfirstName;if(o.value==1)return(s=a.value)==null?void 0:s.sfirstName;if(o.value>=2)return(r=a.value)==null?void 0:r.wards[o.value-2].wfirstName}),G=N(()=>{let l=0;return l+=a.value.wards.length,a.value.slastName&&l++,l});async function H(){o.value++;let l;o.value==1?(l=a.value.aplImg_path.secPath[0],p.value="sec.jpg"):o.value>=2?(l=a.value.aplImg_path.wardsPath[o.value-2],p.value="wards.jpg"):(l=a.value.aplImg_path.primePath[0],p.value="prime.jpg");try{let{data:r,error:d}=await v.storage.from("applicants").createSignedUrl(l,10);if(d)throw d;u.value=r.signedUrl}catch(r){console.log(r),u.value=""}const s=await _.downloadIMG(l);g.value=s}async function V(){if(o.value==0)return;o.value--;let l;o.value==1?(l=a.value.aplImg_path.secPath[0],p.value="sec.jpg"):o.value>=2?(l=a.value.aplImg_path.wardsPath[o.value-2],p.value="wards.jpg"):(l=a.value.aplImg_path.primePath[0],p.value="prime.jpg");try{let{data:r,error:d}=await v.storage.from("applicants").createSignedUrl(l,10);if(d)throw d;u.value=r.signedUrl}catch(r){console.log(r),u.value=""}const s=await _.downloadIMG(l);g.value=s}M(async()=>{try{let{data:s,error:r}=await v.storage.from("applicants").createSignedUrl(a.value.aplImg_path.primePath[0],10);if(r)throw r;u.value=s.signedUrl}catch(s){console.log(s),u.value=""}const l=await _.downloadIMG(a.value.aplImg_path.primePath[0]);g.value=l});function W(){localStorage.removeItem("apl"),w.push("/main")}function y(){chrome.tabs.query({active:!0,currentWindow:!0},function(l){chrome.tabs.sendMessage(l[0].id,{apl:a.value})})}return(l,s)=>{var r,d,h,k,q,C,j,I,P,T;return c(),n("div",z,[e("div",J,[e("div",K,[e("div",{class:"flex items-center gap-1"},[e("span",{class:"cursor-pointer hover:underline hover:uppercase",onClick:W},"home")]),t(o)==0?(c(),n("div",Q,i(t(o)==0?"Primary Applicant":""),1)):t(o)==1?(c(),n("div",X,i(t(o)==1?"Secondary Applicant":""),1)):t(o)+t(D)>=2?(c(),n("div",Y,i(t(o)>=2?`Ward
					Applicant ${t(o)-1}`:""),1)):b("",!0)]),e("div",ee,[e("div",te,[t(u)?(c(),n("div",le,[e("span",ae,i(t(F)),1),e("img",{src:t(u),alt:"",class:"w-full h-full object-cover rounded-lg"},null,8,oe)])):(c(),n("div",se,ne)),e("a",{href:t(g),download:t(p),class:"w-full font-bold rounded-lg bg-neutral-900 hover:bg-amber-600 hover:text-black text-center"},"Download",8,ce),t(o)!==0?(c(),n("div",{key:2,onClick:V,class:"absolute -left-1 top-1/2 -translate-y-1/2 w-6 aspect-square bg-purple-600 rounded-full grid place-items-center font-bold text-black cursor-pointer hover:bg-purple-500 select-none"}," < ")):b("",!0),t(o)!==t(G)?(c(),n("div",{key:3,onClick:H,class:"absolute -right-1 top-1/2 -translate-y-1/2 w-6 aspect-square bg-purple-600 rounded-full grid place-items-center font-bold text-black cursor-pointer hover:bg-purple-500 select-none"}," >")):b("",!0)]),e("div",ie,[e("p",de,[ue,e("span",pe,i((r=t(a))==null?void 0:r.fullName),1)]),e("p",fe,[_e,e("span",null,i(t(_).formatDate(new Date((d=t(a))==null?void 0:d.pdob))),1)]),e("p",he,[ve,e("span",null,i(t(_).formatDate(new Date((h=t(a))==null?void 0:h.created_at))),1)]),e("p",be,[ge,e("span",null,i((k=t(a))==null?void 0:k.pmarital_status),1)]),e("p",me,[xe,e("span",null,i((q=t(a))==null?void 0:q.children_number),1)]),e("p",we,[ye,e("span",null,i((j=(C=t(R))==null?void 0:C.find(Z=>{var S;return Z.id==((S=t(a))==null?void 0:S.user_id)}))==null?void 0:j.fullname),1)])])]),(I=t(a))!=null&&I.pconf_code?(c(),n("div",ke,Ce)):b("",!0),(P=t(a))!=null&&P.pconf_code?(c(),n("div",je,[e("div",{onClick:y,class:"cursor-pointer hover:bg-purple-500 w-full text-center font-bold uppercase text-xl bg-purple-600 text-black border-2 border-purple-700 rounded-xl py-2"}," Fill to Check Results ")])):(c(),n("div",Ie,[e("div",{onClick:y,class:"cursor-pointer hover:bg-purple-500 w-full text-center font-bold uppercase text-xl bg-purple-600 text-black border-2 border-purple-700 rounded-xl py-2"}," Fill to Register ")])),t(m)&&!((T=t(a))!=null&&T.pconf_code)?(c(),n("div",Pe,[e("div",{class:"cursor-pointer hover:bg-amber-500 w-full text-center font-bold uppercase text-xl bg-amber-600 text-black border-2 border-amber-700 rounded-xl py-2",onClick:s[0]||(s[0]=async()=>await B())},[L(" Save Confirmation Code"),Te,L(" "+i(t(m)),1)])])):b("",!0)])])}}});export{Ne as default};
