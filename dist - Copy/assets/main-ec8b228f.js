import{_ as R}from"./RandomText.vue_vue_type_script_setup_true_lang-1ab2db4c.js";import{B as V,C as z,q as n,m as N,D as H,h as q,u as G,E as A,G as I,i as J,c as y,b as l,j as P,H as E,I as j,J as F,y as D,A as x,F as U,z as W,w as K,v as Q,s as X,o as _}from"./base-606b8221.js";import{u as Y,s as Z,a as ee}from"./app-9297243d.js";function te(s){return V()?(z(s),!0):!1}function O(s){return typeof s=="function"?s():n(s)}const oe=typeof window<"u"&&typeof document<"u",ne=()=>{};function re(s){const e=O(s);return(e==null?void 0:e.$el)??e}const $=oe?window:void 0;function B(...s){let e,a,o,p;if(typeof s[0]=="string"||Array.isArray(s[0])?([a,o,p]=s,e=$):[e,a,o,p]=s,!e)return ne;Array.isArray(a)||(a=[a]),Array.isArray(o)||(o=[o]);const c=[],u=()=>{c.forEach(d=>d()),c.length=0},i=(d,g,m,v)=>(d.addEventListener(g,m,v),()=>d.removeEventListener(g,m,v)),f=H(()=>[re(e),O(p)],([d,g])=>{u(),d&&c.push(...a.flatMap(m=>o.map(v=>i(d,m,v,g))))},{immediate:!0,flush:"post"}),h=()=>{f(),u()};return te(h),h}function se(s,e={}){const{delayEnter:a=0,delayLeave:o=0,window:p=$}=e,c=N(!1);let u;const i=f=>{const h=f?a:o;u&&(clearTimeout(u),u=void 0),h?u=setTimeout(()=>c.value=f,h):c.value=f};return p&&(B(s,"mouseenter",()=>i(!0),{passive:!0}),B(s,"mouseleave",()=>i(!1),{passive:!0})),c}const le={class:"min-h-fit p-3 bg-black text-white rounded-md flex flex-col gap-2"},ae={class:"flex flex-col flex-1 bg-neutral-900 rounded-xl border border-neutral-600 border-2 p-3"},ie={class:"flex items-center justify-between w-full h-full"},ce={class:"flex flex-col items-center justify-between"},ue=l("br",null,null,-1),fe={class:"w-full flex flex-col gap-6 flex-1"},de=["value","max"],pe={class:"flex items-center justify-center font-semibold tracking-wider"},he={class:"w-full pt-5 flex gap-2"},me={class:"absolute -top-3 -right-3 min-w-[30px] flex justify-center items-center rounded-full aspect-square bg-red-400 text-black font-bold text-sm border-2 border-red-600"},xe={key:0,class:""},_e={key:1,class:""},ge={class:"flex w-full"},we=q({__name:"main",setup(s){const e=Y(),{search:a,my_apls:o,profile:p,monthly_confirmed_apls:c}=Z(e),u=G(),i=A(()=>o==null?void 0:o.value.length),f=A(()=>o==null?void 0:o.value.filter(t=>t.pconf_code)),h=N(),d=se(h);I(async()=>{await e.getMyApls(),await e.getProfiles(),e.getMonthlyConfirmedApls(),!p.value&&await e.getProfile()}),J(()=>{let t=localStorage.getItem("apl");t&&typeof JSON.parse(t)=="object"&&e.goToApl(JSON.parse(t))});function g(t){return t==8?"AUG":t==9?"SEP":t==10?"OCT":""}function m(t){return t==8?o.value.filter(r=>e.formatToMonth(new Date(r.created_at))=="Aug").filter(r=>r.pconf_code):t==9?o.value.filter(r=>e.formatToMonth(new Date(r.created_at))=="Sep").filter(r=>r.pconf_code):t==10?o.value.filter(r=>e.formatToMonth(new Date(r.created_at))=="Oct").filter(r=>r.pconf_code):null}async function v(){try{let{error:t}=await ee.auth.signOut();if(t)throw t;u.push("/popup")}catch(t){console.log(t)}}const k=A(()=>{let t=e.sortByRecency(o.value).reverse().findIndex(w=>!w.pconf_code);return{apl:e.sortByRecency(o.value).reverse().find(w=>!w.pconf_code),index:t}});async function L(){e.$patch({results:[]});const t=await e.getSearch();(t==null?void 0:t.length)==0&&await e.getSearch(a.value,"applicants_ex"),u.push("/search")}return(t,r)=>{var C;const w=R;return _(),y("div",le,[l("header",{class:j(["flex items-center w-full",n(i)?"justify-between":"justify-end"])},[n(i)?(_(),P(w,{key:0,idx:5,class:"font-semibold text-lg",ctnt:`Hello, ${(C=n(p))==null?void 0:C.fullname} [${n(i)}]`,increment:10,speed:10},null,8,["ctnt"])):E("",!0),l("span",{class:"bg-red-400 hover:bg-red-600 transition-all duration-200 ease-out cursor-pointer text-black px-2 py-1 rounded-xl font-bold",onClick:v}," Sign Out ")],2),l("div",ae,[l("div",ie,[l("section",ce,[l("div",{class:"text-center font-semibold text-purple-400 bg-black radial-progress",style:F(`--value:${n(f)&&n(i)?n(f).length/n(i)*100:0}; --size:8rem; --thickness: 1.2rem;`)},[D(x(n(f)?n(f).length:0)+" / "+x(n(i))+" ",1),ue,D("confirmed ")],4)]),l("section",fe,[(_(!0),y(U,null,W(n(c),(b,S)=>{var T,M;return _(),y("div",{key:S,class:"flex justify-evenly items-center w-full"},[l("progress",{class:"progress w-[70%] h-4",value:(T=m(S+8))==null?void 0:T.length,max:b.val},null,8,de),l("span",pe,x(g(b.month))+": "+x((M=m(S+8))==null?void 0:M.length)+"/"+x(b.val),1)])}),128))])]),l("div",he,[l("button",{ref_key:"btn",ref:h,class:"w-full bg-neutral-700 text-white text-lg font-semibold rounded-xl py-2 px-4 hover:bg-neutral-500 border-4 border-neutral-800 relative",onClick:r[0]||(r[0]=b=>n(e).goToApl(n(k).apl))},[l("span",me,"#"+x(n(k).index+1),1),n(d)?(_(),y("span",_e,x(n(k).apl.fullName),1)):(_(),y("span",xe,"Next to Confirm"))],512)])]),l("div",ge,[K(l("input",{"onUpdate:modelValue":r[1]||(r[1]=b=>X(a)?a.value=b:null),class:"w-full h-12 placeholder:text-neutral-400 placeholder:text-[1rem] placeholder:font-semibold placeholder:uppercase tracking-wider font-semibold text-neutral-300 focus:outline-none bg-neutral-800 border-neutral-600 border-2 rounded-xl text-center text-xl",placeholder:"Search"},null,512),[[Q,n(a),void 0,{trim:!0}]]),n(a).length>0?(_(),y("button",{key:0,class:j(["h-12 bg-neutral-800 border-neutral-600 border-2 rounded-xl text-center font-bold uppercase text-xl aspect-square ml-2 transition-all duration-300 ease-out hover:bg-purple-500"]),onClick:L}," Go ")):E("",!0)])])}}});export{we as default};
